--- origsrc/qt-everywhere-opensource-src-4.8.7/src/gui/image/qiconloader.cpp	2015-05-07 09:14:44.000000000 -0500
+++ src/qt-everywhere-opensource-src-4.8.7/src/gui/image/qiconloader.cpp	2015-05-26 13:21:19.283975700 -0500
@@ -75,6 +75,10 @@ static QString fallbackTheme()
 #ifdef Q_WS_X11
     if (X11->desktopEnvironment == DE_GNOME) {
         return QLatin1String("gnome");
+    } else if (X11->desktopEnvironment == DE_MATE) {
+        return QLatin1String("mate");
+    } else if (X11->desktopEnvironment == DE_LXDE) {
+        return QLatin1String("nuoveXT2");
     } else if (X11->desktopEnvironment == DE_KDE) {
         return X11->desktopVersion >= 4
             ? QString::fromLatin1("oxygen")
--- origsrc/qt-everywhere-opensource-src-4.8.7/src/gui/itemviews/qfileiconprovider.cpp	2015-05-07 09:14:43.000000000 -0500
+++ src/qt-everywhere-opensource-src-4.8.7/src/gui/itemviews/qfileiconprovider.cpp	2015-05-26 13:23:11.804131000 -0500
@@ -413,7 +413,10 @@ QIcon QFileIconProvider::icon(const QFil
         return platformIcon;
 
 #if defined(Q_WS_X11) && !defined(QT_NO_STYLE_GTK)
-    if (X11->desktopEnvironment == DE_GNOME) {
+    switch (X11->desktopEnvironment) {
+    case DE_GNOME:
+    case DE_MATE:
+    case DE_LXDE:
         QIcon gtkIcon = QGtkStylePrivate::getFilesystemIcon(info);
         if (!gtkIcon.isNull())
             return gtkIcon;
--- origsrc/qt-everywhere-opensource-src-4.8.7/src/gui/kernel/qapplication.cpp	2015-05-07 09:14:43.000000000 -0500
+++ src/qt-everywhere-opensource-src-4.8.7/src/gui/kernel/qapplication.cpp	2015-05-26 13:23:59.484196800 -0500
@@ -5550,6 +5550,10 @@ uint QApplicationPrivate::currentPlatfor
         platform |= KB_KDE;
     if (X11->desktopEnvironment == DE_GNOME)
         platform |= KB_Gnome;
+    if (X11->desktopEnvironment == DE_MATE)
+        platform |= KB_Gnome;
+    if (X11->desktopEnvironment == DE_LXDE)
+        platform |= KB_Gnome;
     if (X11->desktopEnvironment == DE_CDE)
         platform |= KB_CDE;
 #elif defined(Q_OS_SYMBIAN)
--- origsrc/qt-everywhere-opensource-src-4.8.7/src/gui/kernel/qapplication_x11.cpp	2015-05-26 13:00:47.111221100 -0500
+++ src/qt-everywhere-opensource-src-4.8.7/src/gui/kernel/qapplication_x11.cpp	2015-05-26 14:39:06.280737100 -0500
@@ -2361,6 +2361,22 @@ void qt_init(QApplicationPrivate *priv,
                 break;
             }
 
+            if (qgetenv("DESKTOP_SESSION") == "mate") {
+                X11->desktopEnvironment = DE_MATE;
+                break;
+            }
+
+            // GNOME_DESKTOP_SESSION_ID is deprecated for some reason, but still check it
+            if (!qgetenv("MATE_DESKTOP_SESSION_ID").isEmpty()) {
+                X11->desktopEnvironment = DE_MATE;
+                break;
+            }
+
+            if (qgetenv("DESKTOP_SESSION") == "LXDE") {
+                X11->desktopEnvironment = DE_LXDE;
+                break;
+            }
+
             rc = XGetWindowProperty(X11->display, QX11Info::appRootWindow(), ATOM(_DT_SAVE_MODE),
                                     0, 2, False, XA_STRING, &type, &format, &length,
                                     &after, &data);
--- origsrc/qt-everywhere-opensource-src-4.8.7/src/gui/kernel/qguiplatformplugin.cpp	2015-05-26 13:00:45.251218500 -0500
+++ src/qt-everywhere-opensource-src-4.8.7/src/gui/kernel/qguiplatformplugin.cpp	2015-05-27 15:50:22.565810600 -0500
@@ -162,6 +162,8 @@ QString QGuiPlatformPlugin::styleName()
     case DE_KDE:
         stylename = QKde::kdeStyle();
         break;
+    case DE_LXDE:
+    case DE_MATE:
     case DE_GNOME: {
         QStringList availableStyles = QStyleFactory::keys();
         // Set QGtkStyle for GNOME if available
@@ -208,13 +210,15 @@ QString QGuiPlatformPlugin::systemIconTh
 {
     QString result;
 #ifdef Q_WS_X11
-    if (X11->desktopEnvironment == DE_GNOME) {
 #ifndef QT_NO_STYLE_GTK
-        result = QGtkStylePrivate::getIconThemeName();
+    result = QGtkStylePrivate::getIconThemeName();
 #endif
-        if (result.isEmpty()) {
+    if (X11->desktopEnvironment == DE_GNOME && result.isEmpty()) {
             result = QString::fromLatin1("gnome");
-        }
+    } else if (X11->desktopEnvironment == DE_MATE && result.isEmpty()) {
+            result = QString::fromLatin1("mate");
+    } else if (X11->desktopEnvironment == DE_LXDE && result.isEmpty()) {
+            result = QString::fromLatin1("nuoveXT2");
     } else if (X11->desktopEnvironment == DE_KDE) {
         result =  X11->desktopVersion >= 4 ? QString::fromLatin1("oxygen") : QString::fromLatin1("crystalsvg");
         QSettings settings(QKde::kdeHome() + QLatin1String("/share/config/kdeglobals"), QSettings::IniFormat);
--- origsrc/qt-everywhere-opensource-src-4.8.7/src/gui/kernel/qt_x11_p.h	2015-05-07 09:14:43.000000000 -0500
+++ src/qt-everywhere-opensource-src-4.8.7/src/gui/kernel/qt_x11_p.h	2015-05-26 14:00:06.537088800 -0500
@@ -341,6 +341,8 @@ enum DesktopEnvironment {
     DE_UNKNOWN,
     DE_KDE,
     DE_GNOME,
+    DE_MATE,
+    DE_LXDE,
     DE_CDE,
     DE_MEEGO_COMPOSITOR,
     DE_4DWM
--- origsrc/qt-everywhere-opensource-src-4.8.7/src/gui/styles/qcommonstyle.cpp	2015-05-07 09:14:43.000000000 -0500
+++ src/qt-everywhere-opensource-src-4.8.7/src/gui/styles/qcommonstyle.cpp	2015-05-26 14:01:31.277205700 -0500
@@ -5074,10 +5074,14 @@ int QCommonStyle::styleHint(StyleHint sh
     case SH_DialogButtonLayout:
         ret = QDialogButtonBox::WinLayout;
 #ifdef Q_WS_X11
-        if (X11->desktopEnvironment == DE_KDE)
+        switch (X11->desktopEnvironment) {
+        case DE_KDE:
             ret = QDialogButtonBox::KdeLayout;
-        else if (X11->desktopEnvironment == DE_GNOME)
+        case DE_GNOME:
+        case DE_MATE:
+        case DE_LXDE:
             ret = QDialogButtonBox::GnomeLayout;
+        }
 #endif
         break;
     case SH_ComboBox_PopupFrameStyle:
--- origsrc/qt-everywhere-opensource-src-4.8.7/src/gui/text/qfontengine_x11.cpp	2015-05-07 09:14:44.000000000 -0500
+++ src/qt-everywhere-opensource-src-4.8.7/src/gui/text/qfontengine_x11.cpp	2015-05-26 14:13:51.312875300 -0500
@@ -1020,7 +1020,9 @@ QFontEngineX11FT::QFontEngineX11FT(FcPat
         int hint_style = 0;
         // Try to use Xft.hintstyle from XDefaults first if running in GNOME, to match
         // the behavior of cairo
-        if (X11->fc_hint_style > -1 && X11->desktopEnvironment == DE_GNOME)
+        if (X11->fc_hint_style > -1 && (X11->desktopEnvironment == DE_GNOME
+                                        || X11->desktopEnvironment == DE_MATE
+                                        || X11->desktopEnvironment == DE_LXDE))
             hint_style = X11->fc_hint_style;
         else if (FcPatternGetInteger (pattern, FC_HINT_STYLE, 0, &hint_style) == FcResultNoMatch
                  && X11->fc_hint_style > -1)
--- origsrc/qt-everywhere-opensource-src-4.8.7/src/gui/util/qdesktopservices_x11.cpp	2015-05-07 09:14:43.000000000 -0500
+++ src/qt-everywhere-opensource-src-4.8.7/src/gui/util/qdesktopservices_x11.cpp	2015-05-26 14:36:31.276519700 -0500
@@ -73,7 +73,10 @@ static bool openDocument(const QUrl &url
 
     // Use the X11->desktopEnvironment value if X11 is non-NULL,
     //  otherwise just attempt to launch command regardless of the desktop environment
-    if ((!X11 || (X11 && X11->desktopEnvironment == DE_GNOME)) && launch(url, QLatin1String("gnome-open"))) {
+    if ((!X11 || (X11 && X11->desktopEnvironment == DE_GNOME)
+              || (X11 && X11->desktopEnvironment == DE_MATE)
+              || (X11 && X11->desktopEnvironment == DE_LXDE))
+              && launch(url, QLatin1String("gvfs-open"))) {
         return true;
     } else {
         if ((!X11 || (X11 && X11->desktopEnvironment == DE_KDE)) && launch(url, QLatin1String("kfmclient exec")))
@@ -108,7 +111,10 @@ static bool launchWebBrowser(const QUrl
 
     // Use the X11->desktopEnvironment value if X11 is non-NULL,
     //  otherwise just attempt to launch command regardless of the desktop environment
-    if ((!X11 || (X11 && X11->desktopEnvironment == DE_GNOME)) && launch(url, QLatin1String("gnome-open"))) {
+    if ((!X11 || (X11 && X11->desktopEnvironment == DE_GNOME)
+              || (X11 && X11->desktopEnvironment == DE_MATE)
+              || (X11 && X11->desktopEnvironment == DE_LXDE))
+              && launch(url, QLatin1String("gvfs-open"))) {
         return true;
     } else {
         if ((!X11 || (X11 && X11->desktopEnvironment == DE_KDE)) && launch(url, QLatin1String("kfmclient openURL")))
